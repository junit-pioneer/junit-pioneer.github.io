<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Clear, Set, and Restore System Properties - JUnit Pioneer</title>
<meta name="description" content="The JUnit 5 (Jupiter) extensions @ClearSystemProperty, @SetSystemProperty and @RestoreSystemProperties clear/set/restore the values of system properties for the duration of a test, and/or restore them after">


  <meta name="author" content="JUnit Pioneers">


<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="JUnit Pioneer">
<meta property="og:title" content="Clear, Set, and Restore System Properties">
<meta property="og:url" content="https://junit-pioneer.org/docs/system-properties/">


  <meta property="og:description" content="The JUnit 5 (Jupiter) extensions @ClearSystemProperty, @SetSystemProperty and @RestoreSystemProperties clear/set/restore the values of system properties for the duration of a test, and/or restore them after">



  <meta property="og:image" content="https://junit-pioneer.org/assets/images/site/type-writer.jpg">





  <meta property="article:published_time" content="2024-10-06T13:48:10+00:00">





  

  


<link rel="canonical" href="https://junit-pioneer.org/docs/system-properties/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "JUnit Pioneers",
      "url": "https://junit-pioneer.org/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="JUnit Pioneer Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single-doc">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          JUnit Pioneer
          <span class="site-subtitle">JUnit 5 Extension Pack</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/docs/">Documentation</a>
            </li><li class="masthead__menu-item">
              <a href="https://javadoc.io/doc/org.junit-pioneer/junit-pioneer">Javadoc</a>
            </li><li class="masthead__menu-item">
              <a href="https://github.com/junit-pioneer/junit-pioneer/releases">Release Notes</a>
            </li><li class="masthead__menu-item">
              <a href="/junit-pioneer/">About</a>
            </li><li class="masthead__menu-item">
              <a href="https://github.com/junit-pioneer/junit-pioneer">GitHub</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      <!-- BEGIN: edited version of page__hero.html -->








<div class="page__hero--overlay"
  style=" background-image: url('/assets/images/site/type-writer.jpg');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline"
        style="">
        
          Clear, Set, and Restore System Properties

        
      </h1>
      


      
      
    </div>
  
  
</div>
<!-- END -->



<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">JUnit Pioneer Extensions</span>
        

        
        <ul>
          
            <li><a href="/docs/replace-camelcase-and-underscore-and-number/">DisplayName generator to replace CamelCase, underscore and numbers</a></li>
          
            <li><a href="/docs/cartesian-product/">Cartesian Product of Parameters</a></li>
          
            <li class="active"><a href="/docs/system-properties/">Clear, Set, and Restore System Properties</a></li>
          
            <li><a href="/docs/environment-variables/">Clear, Set, and Restore Environment Variables</a></li>
          
            <li><a href="/docs/byte-array-converter/">Convert Number Argument to Byte Array</a></li>
          
            <li><a href="/docs/default-locale-timezone/">Default Locale and TimeZone</a></li>
          
            <li><a href="/docs/disabled-until/">Disable a Test Temporarily</a></li>
          
            <li><a href="/docs/disable-if-test-fails/">Disable If Test Fails</a></li>
          
            <li><a href="/docs/disable-parameterized-tests/">Disable Parameterized Tests</a></li>
          
            <li><a href="/docs/expected-to-fail-tests/">Expected-to-Fail Tests</a></li>
          
            <li><a href="/docs/fail-at/">Fail Test at a Date</a></li>
          
            <li><a href="/docs/resources/">Injecting Resources</a></li>
          
            <li><a href="/docs/temp-directory/">Injecting Temporary Directories</a></li>
          
            <li><a href="/docs/issue/">Issue Information</a></li>
          
            <li><a href="/docs/json-argument-source">JSON Argument Source</a></li>
          
            <li><a href="/docs/stopwatch/">Measuring Test Run Time</a></li>
          
            <li><a href="/docs/report-entries/">Publishing Report Entries</a></li>
          
            <li><a href="/docs/range-sources/">Range Sources</a></li>
          
            <li><a href="/docs/retrying-test/">Retrying Failing Tests</a></li>
          
            <li><a href="/docs/standard-input-output/">Standard Input and Output</a></li>
          
            <li><a href="/docs/simple-arguments-aggregator/">Simple Arguments Aggregator</a></li>
          
            <li><a href="/docs/vintage-test/">Vintage @Test</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Clear, Set, and Restore System Properties">
    <meta itemprop="description" content="@ClearSystemProperty and @SetSystemPropertyThe @ClearSystemProperty and @SetSystemProperty annotations can be used to clear and set, respectively, the values of system properties for a test execution.Both annotations work on the test method and class level, are repeatable, combinable, and inherited from higher-level containers.After the annotated method has been executed, the properties mentioned in the annotation will be restored to their original value or the value of the higher-level container, or will be cleared if they didn&#8217;t have one before.Other system properties that are changed during the test, are not restored (unless the @RestoreSystemProperties is used).">
    
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
        <div class="sect1">
<h2 id="clearsystemproperty-and-setsystemproperty"><code>@ClearSystemProperty</code> and <code>@SetSystemProperty</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>@ClearSystemProperty</code> and <code>@SetSystemProperty</code> annotations can be used to clear and set, respectively, the values of system properties for a test execution.
Both annotations work on the test method and class level, are repeatable, combinable, and inherited from higher-level containers.
After the annotated method has been executed, the properties mentioned in the annotation will be restored to their original value or the value of the higher-level container, or will be cleared if they didn&#8217;t have one before.
Other system properties that are changed during the test, are <strong>not</strong> restored (unless the <code>@RestoreSystemProperties</code> is used).</p>
</div>
<div class="paragraph">
<p>For example, clearing a system property for a test execution can be done as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight" style="background: #272822; color: #f8f8f2"><code data-lang="java"><span></span><span style="color: #a6e22e">@Test</span>
<span style="color: #a6e22e">@ClearSystemProperty</span><span style="color: #f8f8f2">(key</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;some property&quot;</span><span style="color: #f8f8f2">)</span>
<span style="color: #66d9ef">void</span> <span style="color: #a6e22e">testClearingProperty</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
    <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;some property&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isNull</span><span style="color: #f8f8f2">();</span>
<span style="color: #f8f8f2">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And setting a system property for a test execution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight" style="background: #272822; color: #f8f8f2"><code data-lang="java"><span></span><span style="color: #a6e22e">@Test</span>
<span style="color: #a6e22e">@SetSystemProperty</span><span style="color: #f8f8f2">(key</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;some property&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">value</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;new value&quot;</span><span style="color: #f8f8f2">)</span>
<span style="color: #66d9ef">void</span> <span style="color: #a6e22e">testSettingProperty</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
    <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;some property&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isEqualTo</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;new value&quot;</span><span style="color: #f8f8f2">);</span>
<span style="color: #f8f8f2">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As mentioned before, both annotations are repeatable and they can also be combined:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight" style="background: #272822; color: #f8f8f2"><code data-lang="java"><span></span><span style="color: #a6e22e">@Test</span>
<span style="color: #a6e22e">@ClearSystemProperty</span><span style="color: #f8f8f2">(key</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;1st property&quot;</span><span style="color: #f8f8f2">)</span>
<span style="color: #a6e22e">@ClearSystemProperty</span><span style="color: #f8f8f2">(key</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;2nd property&quot;</span><span style="color: #f8f8f2">)</span>
<span style="color: #a6e22e">@SetSystemProperty</span><span style="color: #f8f8f2">(key</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;3rd property&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">value</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;new value&quot;</span><span style="color: #f8f8f2">)</span>
<span style="color: #66d9ef">void</span> <span style="color: #a6e22e">testClearingAndSettingProperty</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
    <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;1st property&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isNull</span><span style="color: #f8f8f2">();</span>
    <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;2nd property&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isNull</span><span style="color: #f8f8f2">();</span>
    <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;3rd property&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isEqualTo</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;new value&quot;</span><span style="color: #f8f8f2">);</span>
<span style="color: #f8f8f2">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that class-level configurations are overwritten by method-level configurations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight" style="background: #272822; color: #f8f8f2"><code data-lang="java"><span></span><span style="color: #a6e22e">@ClearSystemProperty</span><span style="color: #f8f8f2">(key</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;some property&quot;</span><span style="color: #f8f8f2">)</span>
<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">MySystemPropertyTest</span> <span style="color: #f8f8f2">{</span>

    <span style="color: #a6e22e">@Test</span>
    <span style="color: #a6e22e">@SetSystemProperty</span><span style="color: #f8f8f2">(key</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;some property&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">value</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;new value&quot;</span><span style="color: #f8f8f2">)</span>
    <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">clearedAtClasslevel</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
        <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;some property&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isEqualTo</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;new value&quot;</span><span style="color: #f8f8f2">);</span>
    <span style="color: #f8f8f2">}</span>

<span style="color: #f8f8f2">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Method-level configurations are visible in both <code>@BeforeEach</code> setup methods and <code>@AfterEach</code> teardown methods (see <a href="https://junit.org/junit5/docs/current/user-guide/#extensions-execution-order-overview">user code and extension code execution order</a>).</p>
</div>
<div class="paragraph">
<p>Since v1.7.0, a class-level configuration means that the specified system properties are cleared/set before and reset after each individual test in the annotated class.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="restoresystemproperties"><code>@RestoreSystemProperties</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>@RestoreSystemProperties</code> can be used to restore changes to system properties made directly in code.
While <code>@ClearSystemProperty</code> and <code>@SetSystemProperty</code> set or clear specific properties and values, they don&#8217;t allow property values to be calculated or parameterized, thus there are times you may want to directly set properties in your test code.
<code>@RestoreSystemProperties</code> can be placed on test methods or test classes and will completely restore all system properties to their original state after a test or test class is complete.</p>
</div>
<div class="paragraph">
<p>In this example, <code>@RestoreSystemProperties</code> is used on a test method, ensuring any changes made in that method are restored:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight" style="background: #272822; color: #f8f8f2"><code data-lang="java"><span></span><span style="color: #a6e22e">@ParameterizedTest</span>
<span style="color: #a6e22e">@ValueSource</span><span style="color: #f8f8f2">(strings</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">{</span> <span style="color: #e6db74">&quot;foo&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;bar&quot;</span> <span style="color: #f8f8f2">})</span>
<span style="color: #a6e22e">@RestoreSystemProperties</span>
<span style="color: #66d9ef">void</span> <span style="color: #a6e22e">parameterizedTest</span><span style="color: #f8f8f2">(String</span> <span style="color: #f8f8f2">value)</span> <span style="color: #f8f8f2">{</span>
    <span style="color: #f8f8f2">System.</span><span style="color: #a6e22e">setProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;some parameterized property&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">value);</span>
    <span style="color: #f8f8f2">System.</span><span style="color: #a6e22e">setProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;some other dynamic property&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;my code calculates somehow&quot;</span><span style="color: #f8f8f2">);</span>
<span style="color: #f8f8f2">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When <code>@RestoreSystemProperties</code> is used on a test class, any system properties changes made during the entire lifecycle of the test class, including test methods, <code>@BeforeAll</code>, <code>@BeforeEach</code> and 'after' methods, are restored after the test class' lifecycle is complete.
In addition, the annotation is inherited by each test method just as if each one was annotated with <code>@RestoreSystemProperties</code>.</p>
</div>
<div class="paragraph">
<p>In the following example, both test methods see the system property changes made in <code>@BeforeAll</code> and <code>@BeforeEach</code>, however, the test methods are isolated from each other (<code>isolatedTest2</code> does not 'see' changes made in <code>isolatedTest1</code>).
As shown in the second example below, the class-level <code>@RestoreSystemProperties</code> ensures that system property changes made within the annotated class are completely restored after the class&#8217;s lifecycle, ensuring that changes are not visible to <code>SomeOtherTestClass</code>.
Note that <code>SomeOtherTestClass</code> uses the <code>@ReadsSystemProperty</code> annotation: This ensures that JUnit does not schedule the class to run during any test known to modify system properties (see <a href="#thread-safety">Thread-Safety</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight" style="background: #272822; color: #f8f8f2"><code data-lang="java"><span></span><span style="color: #a6e22e">@RestoreSystemProperties</span>
<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">MySystemPropertyRestoreTest</span> <span style="color: #f8f8f2">{</span>

    <span style="color: #a6e22e">@BeforeAll</span>
    <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">beforeAll</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
        <span style="color: #f8f8f2">System.</span><span style="color: #a6e22e">setProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;A&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;A value&quot;</span><span style="color: #f8f8f2">);</span>
    <span style="color: #f8f8f2">}</span>

    <span style="color: #a6e22e">@BeforeEach</span>
    <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">beforeEach</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
        <span style="color: #f8f8f2">System.</span><span style="color: #a6e22e">setProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;B&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;B value&quot;</span><span style="color: #f8f8f2">);</span>
    <span style="color: #f8f8f2">}</span>

    <span style="color: #a6e22e">@Test</span>
    <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">isolatedTest1</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
        <span style="color: #f8f8f2">System.</span><span style="color: #a6e22e">setProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;C&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&quot;C value&quot;</span><span style="color: #f8f8f2">);</span>
    <span style="color: #f8f8f2">}</span>

    <span style="color: #a6e22e">@Test</span>
    <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">isolatedTest2</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
        <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;A&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isEqualTo</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;A value&quot;</span><span style="color: #f8f8f2">);</span>
        <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;B&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isEqualTo</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;B value&quot;</span><span style="color: #f8f8f2">);</span>

        <span style="color: #75715e">// Class-level @RestoreSystemProperties restores &quot;C&quot; to original state</span>
        <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;C&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isNull</span><span style="color: #f8f8f2">();</span>
    <span style="color: #f8f8f2">}</span>

<span style="color: #f8f8f2">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Some other test class, running later:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight" style="background: #272822; color: #f8f8f2"><code data-lang="java"><span></span><span style="color: #a6e22e">@ReadsSystemProperty</span>
<span style="color: #66d9ef">class</span> <span style="color: #a6e22e">SomeOtherTestClass</span> <span style="color: #f8f8f2">{</span>

    <span style="color: #a6e22e">@Test</span>
    <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">isolatedTest</span><span style="color: #f8f8f2">()</span> <span style="color: #f8f8f2">{</span>
        <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;A&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isNull</span><span style="color: #f8f8f2">();</span>
        <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;B&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isNull</span><span style="color: #f8f8f2">();</span>
        <span style="color: #f8f8f2">assertThat(System.</span><span style="color: #a6e22e">getProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;C&quot;</span><span style="color: #f8f8f2">)).</span><span style="color: #a6e22e">isNull</span><span style="color: #f8f8f2">();</span>
    <span style="color: #f8f8f2">}</span>

<span style="color: #f8f8f2">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-clearsystemproperty-setsystemproperty-and-restoresystemproperties-together">Using <code>@ClearSystemProperty</code>, <code>@SetSystemProperty</code>, and <code>@RestoreSystemProperties</code> together</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All three annotations can be combined, which could be used when some system properties are parameterized (i.e. need to be set in code) and others are not.
For instance, imagine testing an image generation utility that takes configuration from system properties.
Basic configuration can be specified using <code>Set</code> and <code>Clear</code> and the image size parameterized:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight" style="background: #272822; color: #f8f8f2"><code data-lang="java"><span></span><span style="color: #a6e22e">@ParameterizedTest</span>
<span style="color: #a6e22e">@IntRangeSource</span><span style="color: #f8f8f2">(from</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">to</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">10000</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">step</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">500</span><span style="color: #f8f8f2">)</span>
<span style="color: #a6e22e">@RestoreSystemProperties</span>
<span style="color: #a6e22e">@SetSystemProperty</span><span style="color: #f8f8f2">(key</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;DISABLE_CACHE&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">value</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;TRUE&quot;</span><span style="color: #f8f8f2">)</span>
<span style="color: #a6e22e">@ClearSystemProperty</span><span style="color: #f8f8f2">(key</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;COPYWRITE_OVERLAY_TEXT&quot;</span><span style="color: #f8f8f2">)</span>
<span style="color: #66d9ef">void</span> <span style="color: #a6e22e">imageGenerationTest</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">imageSize)</span> <span style="color: #f8f8f2">{</span>
    <span style="color: #f8f8f2">System.</span><span style="color: #a6e22e">setProperty</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;IMAGE_SIZE&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">String.</span><span style="color: #a6e22e">valueOf</span><span style="color: #f8f8f2">(imageSize));</span> <span style="color: #75715e">// Requires restore</span>

    <span style="color: #75715e">// Test your image generation utility with the current system properties</span>
<span style="color: #f8f8f2">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Using <code>@RestoreSystemProperties</code> is not necessary to restore system properties modified via <code>@ClearSystemProperty</code> or <code>@SetSystemProperty</code> - they each automatically restore the referenced properties.
'Restore', is only needed if system properties are modified in some way <em>other than</em> Clear and Set during a test.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="restoresystemproperties-limitations"><code>@RestoreSystemProperties</code> Limitations</h3>
<div class="paragraph">
<p>The system <code>Properties</code> object is normally just a hashmap of strings, however, it is technically possible to store non-string values and create <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Properties.html#%3Cinit%3E(java.util.Properties)">nested <code>Properties</code> with inherited default values</a>.
<code>@RestoreSystemProperties</code> restores the original <code>Properties</code> object with all of its potential richness <em>after</em> the annotated scope is complete.
However, for use during the test <em>within</em> the test scope it provides a cloned <code>Properties</code> object with these limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Properties with non-string values are removed</p>
</li>
<li>
<p>Nested <code>Properties</code> are flattened into a non-nested instance that has the same effective values, but not necessarily the same structure</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="thread-safety">Thread-Safety</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Since system properties are global state, reading and writing them during <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-parallel-execution">parallel test execution</a> can lead to unpredictable results and flaky tests.
The system property extension is prepared for that and tests annotated with <code>@ClearSystemProperty</code>, <code>@SetSystemProperty</code>, or <code>@RestoreSystemProperties</code> will never execute in parallel (thanks to <a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.api/org/junit/jupiter/api/parallel/ResourceLock.html">resource locks</a>) to guarantee correct test results.</p>
</div>
<div class="paragraph">
<p>However, this does not cover all possible cases.
Tested code that reads or writes system properties <em>independently</em> of the extension can still run in parallel to it and may thus behave erratically when, for example, it unexpectedly reads a property set by the extension in another thread.
Tests that cover code that reads or writes system properties need to be annotated with the respective annotation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@ReadsSystemProperty</code></p>
</li>
<li>
<p><code>@WritesSystemProperty</code> (though consider using <code>@RestoreSystemProperties</code> instead)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Tests annotated in this way will never execute in parallel with tests annotated with <code>@ClearSystemProperty</code>, <code>@SetSystemProperty</code>, or <code>@RestoreSystemProperties</code>.</p>
</div>
</div>
</div>
        
      </section>

      <footer class="page__meta">
        
        


        

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Clear%2C+Set%2C+and+Restore+System+Properties%20https%3A%2F%2Fjunit-pioneer.org%2Fdocs%2Fsystem-properties%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fjunit-pioneer.org%2Fdocs%2Fsystem-properties%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fjunit-pioneer.org%2Fdocs%2Fsystem-properties%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/hashtag/JUnitPioneer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
      
        
          <li><a href="https://github.com/junit-pioneer" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 JUnit Pioneers, <a href="https://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC 4.0</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
